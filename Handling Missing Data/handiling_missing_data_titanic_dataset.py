# -*- coding: utf-8 -*-
"""Handiling Missing Data-Titanic Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DR_GYtKRhWXo9f0gY2eOEaLwdvZpNXQd

#Load the data
"""

import pandas as pd
import numpy as np

data= "https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv"
data=pd.read_csv(data)

print(data.info())

data.head()

data.shape

data.isnull().sum()

"""#Method 1:- Drop columns with Too Many Missing Values"""

#Drop columns with more than 50% missing values

missing_threshold = 0.5*(len(data))
print("missing threshold ->",missing_threshold)

data=data.drop(columns=['Cabin'])
print(data.shape)

"""# Method 2:- Fill Numeric Missing Values with Mean"""

from sklearn.impute import SimpleImputer

#Mean imputation for "Age"

mean_imputer = SimpleImputer(strategy="mean")

data['Age']=mean_imputer.fit_transform(data[['Age']])

data['Age'].isnull().sum()

data.info()

"""#Method 3:- Fill Categorical Missing Values with Mode"""

from sklearn.impute import SimpleImputer

# Fill "Embarked" missing values with most frequent value

mode_impute=SimpleImputer(strategy="most_frequent")

data['Embarked']=mode_impute.fit_transform(data[['Embarked']]).ravel()


data['Embarked'].isnull().sum()

"""#Method 4:- KNN Imputation for "Age"
"""

data= "https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv"
data=pd.read_csv(data)

data.isnull().sum()

from sklearn.impute import KNNImputer

#Numerical Columns

num_cols=['Age','Fare','Pclass']


KNN_imputer=KNNImputer(n_neighbors=5)

data[num_cols]=KNN_imputer.fit_transform(data[num_cols])

data[num_cols].isnull().sum()

"""#Method 5:- Regression Imputation for "Age"
"""

data= "https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv"
data=pd.read_csv(data)

print(data.info())

print(" ")
print(data.isnull().sum())

from sklearn.linear_model import LinearRegression

#Train Model data
data_train= data[data['Age'].notnull()]

# Rows we want to fill
data_missing= data[data['Age'].isnull()]

# Fit the model

model=LinearRegression()

model.fit(data_train[['Fare','Pclass']],data_train['Age'])

# Input Variable:- Fare , Pclass
# Output Variable:- Age


#Predict Missing Values

data.loc[data_missing.index,'Age']= model.predict(data_missing[['Fare','Pclass']])

print(data['Age'].isnull().sum())